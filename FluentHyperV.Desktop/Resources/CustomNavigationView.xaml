<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:markup="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
  xmlns:converters="clr-namespace:FluentHyperV.Desktop.Converters"
>
  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="pack://application:,,,/Wpf.Ui;component/Controls/NavigationView/NavigationViewBasePaneButtonStyle.xaml" />
    <ResourceDictionary Source="pack://application:,,,/Wpf.Ui;component/Controls/NavigationView/NavigationViewItemDefaultStyle.xaml" />
    <ResourceDictionary Source="pack://application:,,,/Wpf.Ui;component/Controls/NavigationView/NavigationViewConstants.xaml" />
  </ResourceDictionary.MergedDictionaries>
  <ControlTemplate markup:Key="CustomNavigationView" TargetType="{markup:Type ui:NavigationView}">
    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
      </Grid.ColumnDefinitions>
      <Grid
        markup:Name="PaneGrid"
        Grid.Column="0"
        Width="{TemplateBinding OpenPaneLength}"
        Margin="4,0"
      >
        <Border markup:Name="PaneBorder">
          <Grid>
            <Grid.RowDefinitions>
              <RowDefinition Height="Auto" />
              <RowDefinition Height="Auto" />
              <RowDefinition Height="*" />
              <RowDefinition Height="Auto" />
              <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <!--  Pane Header (Fixed)  -->
            <Grid Grid.Row="0" Height="0">
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
              </Grid.RowDefinitions>
              <ui:Button
                markup:Name="PART_BackButton"
                Grid.Row="0"
                Margin="0,5,0,5"
                HorizontalAlignment="Left"
                IsEnabled="{TemplateBinding IsBackEnabled}"
                Style="{StaticResource BasePaneButtonStyle}"
                Visibility="{TemplateBinding IsBackButtonVisible,
                                                             Converter={StaticResource BackButtonVisibilityToVisibilityConverter}}"
              >
                <ui:Button.Icon>
                  <ui:SymbolIcon Symbol="ArrowLeft48" />
                </ui:Button.Icon>
              </ui:Button>
              <ui:Button
                markup:Name="PART_ToggleButton"
                Grid.Row="1"
                Margin="0,0,0,5"
                Style="{StaticResource BasePaneButtonStyle}"
                Visibility="{TemplateBinding IsPaneToggleVisible,
                                                             Converter={x:Static converters:ConverterInstance.BooleanToVisibility}}"
              >
                <ui:Button.Icon>
                  <ui:SymbolIcon Symbol="LineHorizontal320" />
                </ui:Button.Icon>
                <ui:Button.Content>
                  <TextBlock FontWeight="Medium" Text="{TemplateBinding PaneTitle}" />
                </ui:Button.Content>
              </ui:Button>
              <!--  Pane Header  -->
              <ContentPresenter Grid.Row="2" Margin="0" Content="{TemplateBinding PaneHeader}" />
              <!--  Auto Suggest Box  -->
              <ContentPresenter
                markup:Name="AutoSuggestBoxContentPresenter"
                Grid.Row="3"
                Margin="0,0,0,6"
                Content="{TemplateBinding AutoSuggestBox}"
              />
              <ui:Button
                markup:Name="PART_AutoSuggestBoxSymbolButton"
                Grid.Row="3"
                Margin="0,0,0,6"
                Icon="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=AutoSuggestBox.Icon}"
                Style="{StaticResource BasePaneButtonStyle}"
                Visibility="Collapsed"
              />
            </Grid>
            <!--  Separator/Shadow for Top  -->
            <!--<Border
                            Grid.Row="1"
                            Height="1"
                            Margin="0,4,0,4"
                            Background="{DynamicResource LeftNavigationViewSeparatorBrush}" />-->
            <!--  Scrollable Menu Items  -->
            <ui:DynamicScrollViewer
              markup:Name="PART_ScrollViewer"
              Grid.Row="2"
              Margin="0,0,-4,0"
              Padding="0,0,4,0"
              CanContentScroll="True"
              HorizontalScrollBarVisibility="Disabled"
              VerticalScrollBarVisibility="Auto"
            >
              <ItemsControl
                markup:Name="PART_MenuItemsItemsControl"
                Focusable="False"
                KeyboardNavigation.DirectionalNavigation="Contained"
                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                ScrollViewer.VerticalScrollBarVisibility="Disabled"
              >
                <ItemsControl.ItemsPanel>
                  <ItemsPanelTemplate>
                    <StackPanel Margin="0" IsItemsHost="True" />
                  </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
              </ItemsControl>
            </ui:DynamicScrollViewer>
            <!--  Separator/Shadow for Footer  -->
            <Border
              Grid.Row="3"
              Height="1"
              Margin="0,4,0,4"
              Background="{DynamicResource LeftNavigationViewSeparatorBrush}"
            />
            <!--  Footer (Fixed)  -->
            <Grid Grid.Row="4">
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
              </Grid.RowDefinitions>
              <ItemsControl
                markup:Name="PART_FooterMenuItemsItemsControl"
                Grid.Row="0"
                Margin="0,0,0,4"
                Focusable="False"
                KeyboardNavigation.DirectionalNavigation="Contained"
                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                ScrollViewer.VerticalScrollBarVisibility="Disabled"
              >
                <ItemsControl.ItemsPanel>
                  <ItemsPanelTemplate>
                    <StackPanel Margin="0" IsItemsHost="True" />
                  </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
              </ItemsControl>
              <ContentPresenter Grid.Row="1" Margin="0" Content="{TemplateBinding PaneFooter}" />
            </Grid>
          </Grid>
        </Border>
      </Grid>
      <Border
        Grid.Column="1"
        Margin="{TemplateBinding FrameMargin}"
        Background="{DynamicResource NavigationViewContentBackground}"
        BorderBrush="{DynamicResource NavigationViewContentGridBorderBrush}"
        BorderThickness="1,1,0,0"
        CornerRadius="8,0,0,0"
      >
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
          </Grid.RowDefinitions>
          <!--  Header (e.g., BreadcrumbBar)  -->
          <ContentPresenter
            Grid.Row="0"
            Margin="0"
            Content="{TemplateBinding Header}"
            Visibility="{TemplateBinding HeaderVisibility}"
          />
          <!--  Page content  -->
          <ui:NavigationViewContentPresenter
            Template="{StaticResource DefaultNavigationViewContentPresenterControlTemplate}"
            markup:Name="PART_NavigationViewContentPresenter"
            Grid.Row="1"
            Padding="{TemplateBinding Padding}"
            Transition="{TemplateBinding Transition}"
            TransitionDuration="{TemplateBinding TransitionDuration}"
          />
          <!--  Overlay (e.g., SnackbarPresenter)  -->
          <ContentPresenter
            Grid.Row="0"
            Grid.RowSpan="2"
            Margin="0"
            Content="{TemplateBinding ContentOverlay}"
          />
        </Grid>
      </Border>
      <VisualStateManager.VisualStateGroups>
        <VisualStateGroup Name="PaneStates">
          <VisualState Name="PaneOpen">
            <Storyboard>
              <DoubleAnimation
                AccelerationRatio="0.4"
                Storyboard.TargetName="PaneGrid"
                Storyboard.TargetProperty="Width"
                From="40"
                To="{TemplateBinding OpenPaneLength}"
                Duration="0:0:.16"
              />
            </Storyboard>
          </VisualState>
          <VisualState Name="PaneCompact">
            <Storyboard>
              <DoubleAnimation
                AccelerationRatio="0.4"
                Storyboard.TargetName="PaneGrid"
                Storyboard.TargetProperty="Width"
                From="{TemplateBinding OpenPaneLength}"
                To="40"
                Duration="0:0:.16"
              />
            </Storyboard>
          </VisualState>
        </VisualStateGroup>
      </VisualStateManager.VisualStateGroups>
    </Grid>
    <ControlTemplate.Triggers>
      <Trigger Property="IsPaneOpen" Value="False">
        <Setter
          TargetName="PART_AutoSuggestBoxSymbolButton"
          Property="Visibility"
          Value="Visible"
        />
        <Setter
          TargetName="AutoSuggestBoxContentPresenter"
          Property="Visibility"
          Value="Collapsed"
        />
        <Setter TargetName="PART_ToggleButton" Property="Content" Value="{markup:Null}" />
      </Trigger>
      <Trigger Property="AutoSuggestBox" Value="{markup:Null}">
        <Setter
          TargetName="PART_AutoSuggestBoxSymbolButton"
          Property="Visibility"
          Value="Collapsed"
        />
      </Trigger>
      <Trigger Property="PaneTitle" Value="{markup:Null}">
        <Setter TargetName="PART_ToggleButton" Property="Content" Value="{markup:Null}" />
        <Setter TargetName="PART_ToggleButton" Property="HorizontalAlignment" Value="Left" />
      </Trigger>
    </ControlTemplate.Triggers>
  </ControlTemplate>
</ResourceDictionary>
